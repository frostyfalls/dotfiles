#!/bin/sh

set -eu

AUDIO_SINK="@DEFAULT_AUDIO_SINK@"

amount=${1}

# Set the volume
case ${amount} in
    toggle) wpctl set-mute "${AUDIO_SINK}" "${amount}" ;;
    *) wpctl set-volume --limit=1.0 "${AUDIO_SINK}" "${amount}" ;;
esac

# Retrieve the volume information
read -r _ volume <<EOF
$(wpctl get-volume "${AUDIO_SINK}")
EOF
volume=${volume%.*}${volume#*.}
volume=${volume#0}
volume=${volume#0}

# Display a notification
notify-send \
    --urgency=low \
    --hint=string:x-dunst-stack-tag:volume \
    --hint=int:value:"${volume}" \
    "Volume"
