#!/bin/sh

set -eu

PASSWORD_STORE_DIR="${PASSWORD_STORE_DIR:-$HOME/.password-store}"

notify() { notify-send "Password Store" "$@"; }

entry="$(find "$PASSWORD_STORE_DIR" -type f -name '*.gpg' -printf '%P\n' | while IFS= read -r line; do
    echo "${line%.gpg}"
done | sort -f | fuzzel --dmenu --prompt='pass ')"

[ -z "$entry" ] && return

pass show -c "$entry" && notify "Copied <b>$entry</b> to the clipboard."
